"use strict";(globalThis.webpackChunkbike_bus=globalThis.webpackChunkbike_bus||[]).push([[965],{1965:(e,t,n)=>{n.r(t),n.d(t,{FirebaseAuthenticationWeb:()=>a});var r=n(6653),i=n(8434),s=n(773);class a extends r.Uw{constructor(){super(),this.lastConfirmationResult=new Map;(0,i.v0)().onAuthStateChanged((e=>this.handleAuthStateChange(e)))}async applyActionCode(e){const t=(0,i.v0)();return(0,i.iA)(t,e.oobCode)}async createUserWithEmailAndPassword(e){const t=(0,i.v0)(),n=await(0,i.Xb)(t,e.email,e.password);return this.createSignInResult(n,null)}async confirmPasswordReset(e){const t=(0,i.v0)();return(0,i.LG)(t,e.oobCode,e.newPassword)}async confirmVerificationCode(e){const{verificationCode:t,verificationId:n}=e,r=this.lastConfirmationResult.get(n);if(!r)throw new Error(a.ERROR_CONFIRMATION_RESULT_MISSING);const i=await r.confirm(t);return this.createSignInResult(i,null)}async deleteUser(){const e=(0,i.v0)().currentUser;if(!e)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return(0,i.h8)(e)}async getCurrentUser(){const e=(0,i.v0)();return{user:this.createUserResult(e.currentUser)}}async getIdToken(e){const t=(0,i.v0)();if(!t.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return{token:await t.currentUser.getIdToken(null===e||void 0===e?void 0:e.forceRefresh)||""}}async getRedirectResult(){const e=(0,i.v0)(),t=await(0,i.cx)(e),n=t?i.O4.credentialFromResult(t):null;return this.createSignInResult(t,n)}async getTenantId(){return{tenantId:(0,i.v0)().tenantId}}async isSignInWithEmailLink(e){const t=(0,i.v0)();return{isSignInWithEmailLink:(0,i.JB)(t,e.emailLink)}}async linkWithApple(e){const t=new i.O4(s.F.APPLE);this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.O4.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithEmailAndPassword(e){const t=i.w9.credential(e.email,e.password),n=await this.linkCurrentUserWithCredential(t);return this.createSignInResult(n,t)}async linkWithEmailLink(e){const t=i.w9.credentialWithLink(e.email,e.emailLink),n=await this.linkCurrentUserWithCredential(t);return this.createSignInResult(n,t)}async linkWithFacebook(e){const t=new i._O;this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i._O.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithGameCenter(){throw new Error("Not available on web.")}async linkWithGithub(e){const t=new i.GH;this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.GH.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithGoogle(e){const t=new i.hJ;this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.hJ.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithMicrosoft(e){const t=new i.O4(s.F.MICROSOFT);this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.O4.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithPhoneNumber(e){const t=(0,i.v0)().currentUser;if(!t)throw new Error(a.ERROR_NO_USER_SIGNED_IN);if(!e.phoneNumber)throw new Error(a.ERROR_PHONE_NUMBER_MISSING);if(!e.recaptchaVerifier||!(e.recaptchaVerifier instanceof i.lI))throw new Error(a.ERROR_RECAPTCHA_VERIFIER_MISSING);try{const n=await(0,i.L6)(t,e.phoneNumber,e.recaptchaVerifier),{verificationId:r}=n;this.lastConfirmationResult.set(r,n);const s={verificationId:r};this.notifyListeners(a.PHONE_CODE_SENT_EVENT,s)}catch(n){const e={message:this.getErrorMessage(n)};this.notifyListeners(a.PHONE_VERIFICATION_FAILED_EVENT,e)}}async linkWithPlayGames(){throw new Error("Not available on web.")}async linkWithTwitter(e){const t=new i.c4;this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.c4.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithYahoo(e){const t=new i.O4(s.F.YAHOO);this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.O4.credentialFromResult(n);return this.createSignInResult(n,r)}async reload(){const e=(0,i.v0)().currentUser;if(!e)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return(0,i.H5)(e)}async sendEmailVerification(){const e=(0,i.v0)().currentUser;if(!e)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return(0,i.w$)(e)}async sendPasswordResetEmail(e){const t=(0,i.v0)();return(0,i.LS)(t,e.email)}async sendSignInLinkToEmail(e){const t=(0,i.v0)();return(0,i.oo)(t,e.email,e.actionCodeSettings)}async setLanguageCode(e){(0,i.v0)().languageCode=e.languageCode}async setPersistence(e){const t=(0,i.v0)();switch(e.persistence){case s.n.BrowserLocal:await(0,i.Fb)(t,i.a$);break;case s.n.BrowserSession:await(0,i.Fb)(t,i.aT);break;case s.n.IndexedDbLocal:await(0,i.Fb)(t,i.AP);break;case s.n.InMemory:await(0,i.Fb)(t,i.BV)}}async setTenantId(e){(0,i.v0)().tenantId=e.tenantId}async signInAnonymously(){const e=(0,i.v0)(),t=await(0,i.XB)(e);return this.createSignInResult(t,null)}async signInWithApple(e){const t=new i.O4(s.F.APPLE);this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.O4.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithCustomToken(e){const t=(0,i.v0)(),n=await(0,i._p)(t,e.token);return this.createSignInResult(n,null)}async signInWithEmailAndPassword(e){const t=(0,i.v0)(),n=await(0,i.e5)(t,e.email,e.password);return this.createSignInResult(n,null)}async signInWithEmailLink(e){const t=(0,i.v0)(),n=await(0,i.P6)(t,e.email,e.emailLink);return this.createSignInResult(n,null)}async signInWithFacebook(e){const t=new i._O;this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i._O.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithGithub(e){const t=new i.GH;this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.GH.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithGoogle(e){const t=new i.hJ;this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.hJ.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithMicrosoft(e){const t=new i.O4(s.F.MICROSOFT);this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.O4.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithPhoneNumber(e){if(!e.phoneNumber)throw new Error(a.ERROR_PHONE_NUMBER_MISSING);if(!e.recaptchaVerifier||!(e.recaptchaVerifier instanceof i.lI))throw new Error(a.ERROR_RECAPTCHA_VERIFIER_MISSING);const t=(0,i.v0)();try{const n=await(0,i.$g)(t,e.phoneNumber,e.recaptchaVerifier),{verificationId:r}=n;this.lastConfirmationResult.set(r,n);const s={verificationId:r};this.notifyListeners(a.PHONE_CODE_SENT_EVENT,s)}catch(n){const e={message:this.getErrorMessage(n)};this.notifyListeners(a.PHONE_VERIFICATION_FAILED_EVENT,e)}}async signInWithPlayGames(){throw new Error("Not available on web.")}async signInWithGameCenter(){throw new Error("Not available on web.")}async signInWithTwitter(e){const t=new i.c4;this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.c4.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithYahoo(e){const t=new i.O4(s.F.YAHOO);this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,null===e||void 0===e?void 0:e.mode),r=i.O4.credentialFromResult(n);return this.createSignInResult(n,r)}async signOut(){const e=(0,i.v0)();await e.signOut()}async unlink(e){const t=(0,i.v0)();if(!t.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);const n=await(0,i.qB)(t.currentUser,e.providerId);return{user:this.createUserResult(n)}}async updateEmail(e){const t=(0,i.v0)().currentUser;if(!t)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return(0,i.s)(t,e.newEmail)}async updatePassword(e){const t=(0,i.v0)().currentUser;if(!t)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return(0,i.gQ)(t,e.newPassword)}async updateProfile(e){const t=(0,i.v0)().currentUser;if(!t)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return(0,i.ck)(t,e)}async useAppLanguage(){(0,i.v0)().useDeviceLanguage()}async useEmulator(e){const t=(0,i.v0)(),n=e.port||9099,r=e.scheme||"http";e.host.includes("://")?(0,i.S$)(t,`${e.host}:${n}`):(0,i.S$)(t,`${r}://${e.host}:${n}`)}handleAuthStateChange(e){const t={user:this.createUserResult(e)};this.notifyListeners(a.AUTH_STATE_CHANGE_EVENT,t)}applySignInOptions(e,t){if(e.customParameters){const n={};e.customParameters.map((e=>{n[e.key]=e.value})),t.setCustomParameters(n)}if(e.scopes)for(const n of e.scopes)t.addScope(n)}signInWithPopupOrRedirect(e,t){const n=(0,i.v0)();return"redirect"===t?(0,i.F6)(n,e):(0,i.rh)(n,e)}linkCurrentUserWithPopupOrRedirect(e,t){const n=(0,i.v0)();if(!n.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return"redirect"===t?(0,i.WV)(n.currentUser,e):(0,i.k9)(n.currentUser,e)}linkCurrentUserWithCredential(e){const t=(0,i.v0)();if(!t.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return(0,i.ZJ)(t.currentUser,e)}createSignInResult(e,t){return{user:this.createUserResult((null===e||void 0===e?void 0:e.user)||null),credential:this.createCredentialResult(t),additionalUserInfo:this.createAdditionalUserInfoResult(e)}}createCredentialResult(e){if(!e)return null;const t={providerId:e.providerId};return e instanceof i.jh&&(t.accessToken=e.accessToken,t.idToken=e.idToken,t.secret=e.secret),t}createUserResult(e){if(!e)return null;return{displayName:e.displayName,email:e.email,emailVerified:e.emailVerified,isAnonymous:e.isAnonymous,metadata:this.createUserMetadataResult(e.metadata),phoneNumber:e.phoneNumber,photoUrl:e.photoURL,providerData:this.createUserProviderDataResult(e.providerData),providerId:e.providerId,tenantId:e.tenantId,uid:e.uid}}createUserMetadataResult(e){const t={};return e.creationTime&&(t.creationTime=Date.parse(e.creationTime)),e.lastSignInTime&&(t.lastSignInTime=Date.parse(e.lastSignInTime)),t}createUserProviderDataResult(e){return e.map((e=>({displayName:e.displayName,email:e.email,phoneNumber:e.phoneNumber,photoUrl:e.photoURL,providerId:e.providerId,uid:e.uid})))}createAdditionalUserInfoResult(e){if(!e)return null;const t=(0,i.gK)(e);if(!t)return null;const{isNewUser:n,profile:r,providerId:s,username:a}=t,o={isNewUser:n};return null!==s&&(o.providerId=s),null!==r&&(o.profile=r),null!==a&&void 0!==a&&(o.username=a),o}getErrorMessage(e){return e instanceof Object&&"message"in e&&"string"===typeof e.message?e.message:JSON.stringify(e)}}a.AUTH_STATE_CHANGE_EVENT="authStateChange",a.PHONE_CODE_SENT_EVENT="phoneCodeSent",a.PHONE_VERIFICATION_FAILED_EVENT="phoneVerificationFailed",a.ERROR_NO_USER_SIGNED_IN="No user is signed in.",a.ERROR_PHONE_NUMBER_MISSING="phoneNumber must be provided.",a.ERROR_RECAPTCHA_VERIFIER_MISSING="recaptchaVerifier must be provided and must be an instance of RecaptchaVerifier.",a.ERROR_CONFIRMATION_RESULT_MISSING="No confirmation result with this verification id was found."}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUs3SixNQUNab0QsWUFBYXlHLEVBQUt6RyxZQUNsQmdHLFNBQVVTLEVBQUtSLFNBQ2YzQyxXQUFZbUQsRUFBS25ELFdBQ2pCOEMsSUFBS0ssRUFBS0wsT0FFZCxDQUVRZiw4QkFBQUEsQ0FDTm5HLEdBRUEsSUFBS0EsRUFDSCxPQUFPLEtBRVQsTUFBTWtHLEdBQXFCc0IsRUFBQUEsRUFBQUEsSUFBc0J4SCxHQUNqRCxJQUFLa0csRUFDSCxPQUFPLEtBRVQsTUFBTSxVQUFFdUIsRUFBUyxRQUFFQyxFQUFPLFdBQUV0RCxFQUFVLFNBQUV1RCxHQUFhekIsRUFDL0NFLEVBQTZCLENBQ2pDcUIsYUFXRixPQVRtQixPQUFmckQsSUFDRmdDLEVBQU9oQyxXQUFhQSxHQUVOLE9BQVpzRCxJQUNGdEIsRUFBT3NCLFFBQVVBLEdBRUYsT0FBYkMsUUFBa0NDLElBQWJELElBQ3ZCdkIsRUFBT3VCLFNBQVdBLEdBRWJ2QixDQUNULENBRVEzRSxlQUFBQSxDQUFnQkYsR0FDdEIsT0FDRUEsYUFBaUJzRyxRQUNqQixZQUFhdEcsR0FDZSxrQkFBckJBLEVBQWUsUUFFZkEsRUFBZSxRQUVqQnVHLEtBQUtDLFVBQVV4RyxFQUN4QixFQXh3QnVCOUUsRUFBQXlJLHdCQUEwQixrQkFDMUJ6SSxFQUFBNkUsc0JBQXdCLGdCQUN4QjdFLEVBQUFpRixnQ0FDckIsMEJBQ3FCakYsRUFBQWdDLHdCQUEwQix3QkFDMUJoQyxFQUFBc0UsMkJBQ3JCLGdDQUNxQnRFLEVBQUF5RSxpQ0FDckIsbUZBQ3FCekUsRUFBQTRCLGtDQUNyQiw2RCIsInNvdXJjZXMiOlsiLi4vbm9kZV9tb2R1bGVzL0BjYXBhY2l0b3ItZmlyZWJhc2UvYXV0aGVudGljYXRpb24vc3JjL3dlYi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBXZWJQbHVnaW4gfSBmcm9tICdAY2FwYWNpdG9yL2NvcmUnO1xuaW1wb3J0IHR5cGUge1xuICBDb25maXJtYXRpb25SZXN1bHQsXG4gIEF1dGhDcmVkZW50aWFsIGFzIEZpcmViYXNlQXV0aENyZWRlbnRpYWwsXG4gIEF1dGhQcm92aWRlciBhcyBGaXJlYmFzZUF1dGhQcm92aWRlcixcbiAgQ3VzdG9tUGFyYW1ldGVycyBhcyBGaXJlYmFzZUN1c3RvbVBhcmFtZXRlcnMsXG4gIFVzZXIgYXMgRmlyZWJhc2VVc2VyLFxuICBVc2VyQ3JlZGVudGlhbCBhcyBGaXJlYmFzZVVzZXJDcmVkZW50aWFsLFxuICBVc2VySW5mbyBhcyBGaXJlYmFzZVVzZXJJbmZvLFxuICBVc2VyTWV0YWRhdGEgYXMgRmlyZWJhc2VVc2VyTWVhdGRhdGEsXG59IGZyb20gJ2ZpcmViYXNlL2F1dGgnO1xuaW1wb3J0IHtcbiAgRW1haWxBdXRoUHJvdmlkZXIsXG4gIEZhY2Vib29rQXV0aFByb3ZpZGVyLFxuICBHaXRodWJBdXRoUHJvdmlkZXIsXG4gIEdvb2dsZUF1dGhQcm92aWRlcixcbiAgT0F1dGhDcmVkZW50aWFsLFxuICBPQXV0aFByb3ZpZGVyLFxuICBSZWNhcHRjaGFWZXJpZmllcixcbiAgVHdpdHRlckF1dGhQcm92aWRlcixcbiAgYXBwbHlBY3Rpb25Db2RlLFxuICBicm93c2VyTG9jYWxQZXJzaXN0ZW5jZSxcbiAgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSxcbiAgY29uZmlybVBhc3N3b3JkUmVzZXQsXG4gIGNvbm5lY3RBdXRoRW11bGF0b3IsXG4gIGNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZCxcbiAgZGVsZXRlVXNlcixcbiAgZ2V0QWRkaXRpb25hbFVzZXJJbmZvLFxuICBnZXRBdXRoLFxuICBnZXRSZWRpcmVjdFJlc3VsdCxcbiAgaW5NZW1vcnlQZXJzaXN0ZW5jZSxcbiAgaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZSxcbiAgaXNTaWduSW5XaXRoRW1haWxMaW5rLFxuICBsaW5rV2l0aENyZWRlbnRpYWwsXG4gIGxpbmtXaXRoUGhvbmVOdW1iZXIsXG4gIGxpbmtXaXRoUG9wdXAsXG4gIGxpbmtXaXRoUmVkaXJlY3QsXG4gIHJlbG9hZCxcbiAgc2VuZEVtYWlsVmVyaWZpY2F0aW9uLFxuICBzZW5kUGFzc3dvcmRSZXNldEVtYWlsLFxuICBzZW5kU2lnbkluTGlua1RvRW1haWwsXG4gIHNldFBlcnNpc3RlbmNlLFxuICBzaWduSW5Bbm9ueW1vdXNseSxcbiAgc2lnbkluV2l0aEN1c3RvbVRva2VuLFxuICBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZCxcbiAgc2lnbkluV2l0aEVtYWlsTGluayxcbiAgc2lnbkluV2l0aFBob25lTnVtYmVyLFxuICBzaWduSW5XaXRoUG9wdXAsXG4gIHNpZ25JbldpdGhSZWRpcmVjdCxcbiAgdW5saW5rLFxuICB1cGRhdGVFbWFpbCxcbiAgdXBkYXRlUGFzc3dvcmQsXG4gIHVwZGF0ZVByb2ZpbGUsXG59IGZyb20gJ2ZpcmViYXNlL2F1dGgnO1xuXG5pbXBvcnQgdHlwZSB7XG4gIEFkZGl0aW9uYWxVc2VySW5mbyxcbiAgQXBwbHlBY3Rpb25Db2RlT3B0aW9ucyxcbiAgQXV0aENyZWRlbnRpYWwsXG4gIEF1dGhTdGF0ZUNoYW5nZSxcbiAgQ29uZmlybVBhc3N3b3JkUmVzZXRPcHRpb25zLFxuICBDb25maXJtVmVyaWZpY2F0aW9uQ29kZU9wdGlvbnMsXG4gIENyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZE9wdGlvbnMsXG4gIEZpcmViYXNlQXV0aGVudGljYXRpb25QbHVnaW4sXG4gIEdldEN1cnJlbnRVc2VyUmVzdWx0LFxuICBHZXRJZFRva2VuT3B0aW9ucyxcbiAgR2V0SWRUb2tlblJlc3VsdCxcbiAgR2V0VGVuYW50SWRSZXN1bHQsXG4gIElzU2lnbkluV2l0aEVtYWlsTGlua09wdGlvbnMsXG4gIElzU2lnbkluV2l0aEVtYWlsTGlua1Jlc3VsdCxcbiAgTGlua1Jlc3VsdCxcbiAgTGlua1dpdGhFbWFpbEFuZFBhc3N3b3JkT3B0aW9ucyxcbiAgTGlua1dpdGhFbWFpbExpbmtPcHRpb25zLFxuICBMaW5rV2l0aE9BdXRoT3B0aW9ucyxcbiAgTGlua1dpdGhQaG9uZU51bWJlck9wdGlvbnMsXG4gIFBob25lQ29kZVNlbnRFdmVudCxcbiAgUGhvbmVWZXJpZmljYXRpb25GYWlsZWRFdmVudCxcbiAgU2VuZFBhc3N3b3JkUmVzZXRFbWFpbE9wdGlvbnMsXG4gIFNlbmRTaWduSW5MaW5rVG9FbWFpbE9wdGlvbnMsXG4gIFNldExhbmd1YWdlQ29kZU9wdGlvbnMsXG4gIFNldFBlcnNpc3RlbmNlT3B0aW9ucyxcbiAgU2V0VGVuYW50SWRPcHRpb25zLFxuICBTaWduSW5SZXN1bHQsXG4gIFNpZ25JbldpdGhDdXN0b21Ub2tlbk9wdGlvbnMsXG4gIFNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkT3B0aW9ucyxcbiAgU2lnbkluV2l0aEVtYWlsTGlua09wdGlvbnMsXG4gIFNpZ25JbldpdGhPQXV0aE9wdGlvbnMsXG4gIFNpZ25JbldpdGhQaG9uZU51bWJlck9wdGlvbnMsXG4gIFVubGlua09wdGlvbnMsXG4gIFVubGlua1Jlc3VsdCxcbiAgVXBkYXRlRW1haWxPcHRpb25zLFxuICBVcGRhdGVQYXNzd29yZE9wdGlvbnMsXG4gIFVwZGF0ZVByb2ZpbGVPcHRpb25zLFxuICBVc2VFbXVsYXRvck9wdGlvbnMsXG4gIFVzZXIsXG4gIFVzZXJJbmZvLFxuICBVc2VyTWV0YWRhdGEsXG59IGZyb20gJy4vZGVmaW5pdGlvbnMnO1xuaW1wb3J0IHsgUGVyc2lzdGVuY2UsIFByb3ZpZGVySWQgfSBmcm9tICcuL2RlZmluaXRpb25zJztcblxuZXhwb3J0IGNsYXNzIEZpcmViYXNlQXV0aGVudGljYXRpb25XZWJcbiAgZXh0ZW5kcyBXZWJQbHVnaW5cbiAgaW1wbGVtZW50cyBGaXJlYmFzZUF1dGhlbnRpY2F0aW9uUGx1Z2luXG57XG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgQVVUSF9TVEFURV9DSEFOR0VfRVZFTlQgPSAnYXV0aFN0YXRlQ2hhbmdlJztcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBQSE9ORV9DT0RFX1NFTlRfRVZFTlQgPSAncGhvbmVDb2RlU2VudCc7XG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgUEhPTkVfVkVSSUZJQ0FUSU9OX0ZBSUxFRF9FVkVOVCA9XG4gICAgJ3Bob25lVmVyaWZpY2F0aW9uRmFpbGVkJztcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBFUlJPUl9OT19VU0VSX1NJR05FRF9JTiA9ICdObyB1c2VyIGlzIHNpZ25lZCBpbi4nO1xuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEVSUk9SX1BIT05FX05VTUJFUl9NSVNTSU5HID1cbiAgICAncGhvbmVOdW1iZXIgbXVzdCBiZSBwcm92aWRlZC4nO1xuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEVSUk9SX1JFQ0FQVENIQV9WRVJJRklFUl9NSVNTSU5HID1cbiAgICAncmVjYXB0Y2hhVmVyaWZpZXIgbXVzdCBiZSBwcm92aWRlZCBhbmQgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiBSZWNhcHRjaGFWZXJpZmllci4nO1xuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEVSUk9SX0NPTkZJUk1BVElPTl9SRVNVTFRfTUlTU0lORyA9XG4gICAgJ05vIGNvbmZpcm1hdGlvbiByZXN1bHQgd2l0aCB0aGlzIHZlcmlmaWNhdGlvbiBpZCB3YXMgZm91bmQuJztcblxuICBwcml2YXRlIGxhc3RDb25maXJtYXRpb25SZXN1bHQ6IE1hcDxzdHJpbmcsIENvbmZpcm1hdGlvblJlc3VsdD4gPSBuZXcgTWFwKCk7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpO1xuICAgIGF1dGgub25BdXRoU3RhdGVDaGFuZ2VkKHVzZXIgPT4gdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UodXNlcikpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGFwcGx5QWN0aW9uQ29kZShvcHRpb25zOiBBcHBseUFjdGlvbkNvZGVPcHRpb25zKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICByZXR1cm4gYXBwbHlBY3Rpb25Db2RlKGF1dGgsIG9wdGlvbnMub29iQ29kZSk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkKFxuICAgIG9wdGlvbnM6IENyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZE9wdGlvbnMsXG4gICk6IFByb21pc2U8U2lnbkluUmVzdWx0PiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IGNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZChcbiAgICAgIGF1dGgsXG4gICAgICBvcHRpb25zLmVtYWlsLFxuICAgICAgb3B0aW9ucy5wYXNzd29yZCxcbiAgICApO1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVNpZ25JblJlc3VsdCh1c2VyQ3JlZGVudGlhbCwgbnVsbCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgY29uZmlybVBhc3N3b3JkUmVzZXQoXG4gICAgb3B0aW9uczogQ29uZmlybVBhc3N3b3JkUmVzZXRPcHRpb25zLFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpO1xuICAgIHJldHVybiBjb25maXJtUGFzc3dvcmRSZXNldChhdXRoLCBvcHRpb25zLm9vYkNvZGUsIG9wdGlvbnMubmV3UGFzc3dvcmQpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGNvbmZpcm1WZXJpZmljYXRpb25Db2RlKFxuICAgIG9wdGlvbnM6IENvbmZpcm1WZXJpZmljYXRpb25Db2RlT3B0aW9ucyxcbiAgKTogUHJvbWlzZTxTaWduSW5SZXN1bHQ+IHtcbiAgICBjb25zdCB7IHZlcmlmaWNhdGlvbkNvZGUsIHZlcmlmaWNhdGlvbklkIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IGNvbmZpcm1hdGlvblJlc3VsdCA9IHRoaXMubGFzdENvbmZpcm1hdGlvblJlc3VsdC5nZXQodmVyaWZpY2F0aW9uSWQpO1xuICAgIGlmICghY29uZmlybWF0aW9uUmVzdWx0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIEZpcmViYXNlQXV0aGVudGljYXRpb25XZWIuRVJST1JfQ09ORklSTUFUSU9OX1JFU1VMVF9NSVNTSU5HLFxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBjb25maXJtYXRpb25SZXN1bHQuY29uZmlybSh2ZXJpZmljYXRpb25Db2RlKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTaWduSW5SZXN1bHQodXNlckNyZWRlbnRpYWwsIG51bGwpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGRlbGV0ZVVzZXIoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBjb25zdCBjdXJyZW50VXNlciA9IGF1dGguY3VycmVudFVzZXI7XG4gICAgaWYgKCFjdXJyZW50VXNlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKEZpcmViYXNlQXV0aGVudGljYXRpb25XZWIuRVJST1JfTk9fVVNFUl9TSUdORURfSU4pO1xuICAgIH1cbiAgICByZXR1cm4gZGVsZXRlVXNlcihjdXJyZW50VXNlcik7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZ2V0Q3VycmVudFVzZXIoKTogUHJvbWlzZTxHZXRDdXJyZW50VXNlclJlc3VsdD4ge1xuICAgIGNvbnN0IGF1dGggPSBnZXRBdXRoKCk7XG4gICAgY29uc3QgdXNlclJlc3VsdCA9IHRoaXMuY3JlYXRlVXNlclJlc3VsdChhdXRoLmN1cnJlbnRVc2VyKTtcbiAgICBjb25zdCByZXN1bHQ6IEdldEN1cnJlbnRVc2VyUmVzdWx0ID0ge1xuICAgICAgdXNlcjogdXNlclJlc3VsdCxcbiAgICB9O1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZ2V0SWRUb2tlbihcbiAgICBvcHRpb25zPzogR2V0SWRUb2tlbk9wdGlvbnMsXG4gICk6IFByb21pc2U8R2V0SWRUb2tlblJlc3VsdD4ge1xuICAgIGNvbnN0IGF1dGggPSBnZXRBdXRoKCk7XG4gICAgaWYgKCFhdXRoLmN1cnJlbnRVc2VyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoRmlyZWJhc2VBdXRoZW50aWNhdGlvbldlYi5FUlJPUl9OT19VU0VSX1NJR05FRF9JTik7XG4gICAgfVxuICAgIGNvbnN0IGlkVG9rZW4gPSBhd2FpdCBhdXRoLmN1cnJlbnRVc2VyLmdldElkVG9rZW4ob3B0aW9ucz8uZm9yY2VSZWZyZXNoKTtcbiAgICBjb25zdCByZXN1bHQ6IEdldElkVG9rZW5SZXN1bHQgPSB7XG4gICAgICB0b2tlbjogaWRUb2tlbiB8fCAnJyxcbiAgICB9O1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZ2V0UmVkaXJlY3RSZXN1bHQoKTogUHJvbWlzZTxTaWduSW5SZXN1bHQ+IHtcbiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpO1xuICAgIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XG4gICAgY29uc3QgYXV0aENyZWRlbnRpYWwgPSB1c2VyQ3JlZGVudGlhbFxuICAgICAgPyBPQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKVxuICAgICAgOiBudWxsO1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVNpZ25JblJlc3VsdCh1c2VyQ3JlZGVudGlhbCwgYXV0aENyZWRlbnRpYWwpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGdldFRlbmFudElkKCk6IFByb21pc2U8R2V0VGVuYW50SWRSZXN1bHQ+IHtcbiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpO1xuICAgIHJldHVybiB7XG4gICAgICB0ZW5hbnRJZDogYXV0aC50ZW5hbnRJZCxcbiAgICB9O1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGlzU2lnbkluV2l0aEVtYWlsTGluayhcbiAgICBvcHRpb25zOiBJc1NpZ25JbldpdGhFbWFpbExpbmtPcHRpb25zLFxuICApOiBQcm9taXNlPElzU2lnbkluV2l0aEVtYWlsTGlua1Jlc3VsdD4ge1xuICAgIGNvbnN0IGF1dGggPSBnZXRBdXRoKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzU2lnbkluV2l0aEVtYWlsTGluazogaXNTaWduSW5XaXRoRW1haWxMaW5rKGF1dGgsIG9wdGlvbnMuZW1haWxMaW5rKSxcbiAgICB9O1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGxpbmtXaXRoQXBwbGUoXG4gICAgb3B0aW9ucz86IExpbmtXaXRoT0F1dGhPcHRpb25zLFxuICApOiBQcm9taXNlPExpbmtSZXN1bHQ+IHtcbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBPQXV0aFByb3ZpZGVyKFByb3ZpZGVySWQuQVBQTEUpO1xuICAgIHRoaXMuYXBwbHlTaWduSW5PcHRpb25zKG9wdGlvbnMgfHwge30sIHByb3ZpZGVyKTtcbiAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHRoaXMubGlua0N1cnJlbnRVc2VyV2l0aFBvcHVwT3JSZWRpcmVjdChcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgb3B0aW9ucz8ubW9kZSxcbiAgICApO1xuICAgIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gT0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCk7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlU2lnbkluUmVzdWx0KHVzZXJDcmVkZW50aWFsLCBhdXRoQ3JlZGVudGlhbCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgbGlua1dpdGhFbWFpbEFuZFBhc3N3b3JkKFxuICAgIG9wdGlvbnM6IExpbmtXaXRoRW1haWxBbmRQYXNzd29yZE9wdGlvbnMsXG4gICk6IFByb21pc2U8TGlua1Jlc3VsdD4ge1xuICAgIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gRW1haWxBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChcbiAgICAgIG9wdGlvbnMuZW1haWwsXG4gICAgICBvcHRpb25zLnBhc3N3b3JkLFxuICAgICk7XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCB0aGlzLmxpbmtDdXJyZW50VXNlcldpdGhDcmVkZW50aWFsKFxuICAgICAgYXV0aENyZWRlbnRpYWwsXG4gICAgKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTaWduSW5SZXN1bHQodXNlckNyZWRlbnRpYWwsIGF1dGhDcmVkZW50aWFsKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBsaW5rV2l0aEVtYWlsTGluayhcbiAgICBvcHRpb25zOiBMaW5rV2l0aEVtYWlsTGlua09wdGlvbnMsXG4gICk6IFByb21pc2U8TGlua1Jlc3VsdD4ge1xuICAgIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gRW1haWxBdXRoUHJvdmlkZXIuY3JlZGVudGlhbFdpdGhMaW5rKFxuICAgICAgb3B0aW9ucy5lbWFpbCxcbiAgICAgIG9wdGlvbnMuZW1haWxMaW5rLFxuICAgICk7XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCB0aGlzLmxpbmtDdXJyZW50VXNlcldpdGhDcmVkZW50aWFsKFxuICAgICAgYXV0aENyZWRlbnRpYWwsXG4gICAgKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTaWduSW5SZXN1bHQodXNlckNyZWRlbnRpYWwsIGF1dGhDcmVkZW50aWFsKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBsaW5rV2l0aEZhY2Vib29rKFxuICAgIG9wdGlvbnM/OiBMaW5rV2l0aE9BdXRoT3B0aW9ucyxcbiAgKTogUHJvbWlzZTxMaW5rUmVzdWx0PiB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcbiAgICB0aGlzLmFwcGx5U2lnbkluT3B0aW9ucyhvcHRpb25zIHx8IHt9LCBwcm92aWRlcik7XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCB0aGlzLmxpbmtDdXJyZW50VXNlcldpdGhQb3B1cE9yUmVkaXJlY3QoXG4gICAgICBwcm92aWRlcixcbiAgICAgIG9wdGlvbnM/Lm1vZGUsXG4gICAgKTtcbiAgICBjb25zdCBhdXRoQ3JlZGVudGlhbCA9XG4gICAgICBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCk7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlU2lnbkluUmVzdWx0KHVzZXJDcmVkZW50aWFsLCBhdXRoQ3JlZGVudGlhbCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgbGlua1dpdGhHYW1lQ2VudGVyKCk6IFByb21pc2U8TGlua1Jlc3VsdD4ge1xuICAgIHRocm93IG5ldyBFcnJvcignTm90IGF2YWlsYWJsZSBvbiB3ZWIuJyk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgbGlua1dpdGhHaXRodWIoXG4gICAgb3B0aW9ucz86IExpbmtXaXRoT0F1dGhPcHRpb25zLFxuICApOiBQcm9taXNlPExpbmtSZXN1bHQ+IHtcbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBHaXRodWJBdXRoUHJvdmlkZXIoKTtcbiAgICB0aGlzLmFwcGx5U2lnbkluT3B0aW9ucyhvcHRpb25zIHx8IHt9LCBwcm92aWRlcik7XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCB0aGlzLmxpbmtDdXJyZW50VXNlcldpdGhQb3B1cE9yUmVkaXJlY3QoXG4gICAgICBwcm92aWRlcixcbiAgICAgIG9wdGlvbnM/Lm1vZGUsXG4gICAgKTtcbiAgICBjb25zdCBhdXRoQ3JlZGVudGlhbCA9XG4gICAgICBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpO1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVNpZ25JblJlc3VsdCh1c2VyQ3JlZGVudGlhbCwgYXV0aENyZWRlbnRpYWwpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGxpbmtXaXRoR29vZ2xlKFxuICAgIG9wdGlvbnM/OiBMaW5rV2l0aE9BdXRoT3B0aW9ucyxcbiAgKTogUHJvbWlzZTxMaW5rUmVzdWx0PiB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgR29vZ2xlQXV0aFByb3ZpZGVyKCk7XG4gICAgdGhpcy5hcHBseVNpZ25Jbk9wdGlvbnMob3B0aW9ucyB8fCB7fSwgcHJvdmlkZXIpO1xuICAgIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgdGhpcy5saW5rQ3VycmVudFVzZXJXaXRoUG9wdXBPclJlZGlyZWN0KFxuICAgICAgcHJvdmlkZXIsXG4gICAgICBvcHRpb25zPy5tb2RlLFxuICAgICk7XG4gICAgY29uc3QgYXV0aENyZWRlbnRpYWwgPVxuICAgICAgR29vZ2xlQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTaWduSW5SZXN1bHQodXNlckNyZWRlbnRpYWwsIGF1dGhDcmVkZW50aWFsKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBsaW5rV2l0aE1pY3Jvc29mdChcbiAgICBvcHRpb25zPzogTGlua1dpdGhPQXV0aE9wdGlvbnMsXG4gICk6IFByb21pc2U8TGlua1Jlc3VsdD4ge1xuICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IE9BdXRoUHJvdmlkZXIoUHJvdmlkZXJJZC5NSUNST1NPRlQpO1xuICAgIHRoaXMuYXBwbHlTaWduSW5PcHRpb25zKG9wdGlvbnMgfHwge30sIHByb3ZpZGVyKTtcbiAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHRoaXMubGlua0N1cnJlbnRVc2VyV2l0aFBvcHVwT3JSZWRpcmVjdChcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgb3B0aW9ucz8ubW9kZSxcbiAgICApO1xuICAgIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gT0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCk7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlU2lnbkluUmVzdWx0KHVzZXJDcmVkZW50aWFsLCBhdXRoQ3JlZGVudGlhbCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgbGlua1dpdGhQaG9uZU51bWJlcihcbiAgICBvcHRpb25zOiBMaW5rV2l0aFBob25lTnVtYmVyT3B0aW9ucyxcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBjb25zdCBjdXJyZW50VXNlciA9IGF1dGguY3VycmVudFVzZXI7XG4gICAgaWYgKCFjdXJyZW50VXNlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKEZpcmViYXNlQXV0aGVudGljYXRpb25XZWIuRVJST1JfTk9fVVNFUl9TSUdORURfSU4pO1xuICAgIH1cbiAgICBpZiAoIW9wdGlvbnMucGhvbmVOdW1iZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihGaXJlYmFzZUF1dGhlbnRpY2F0aW9uV2ViLkVSUk9SX1BIT05FX05VTUJFUl9NSVNTSU5HKTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgIW9wdGlvbnMucmVjYXB0Y2hhVmVyaWZpZXIgfHxcbiAgICAgICEob3B0aW9ucy5yZWNhcHRjaGFWZXJpZmllciBpbnN0YW5jZW9mIFJlY2FwdGNoYVZlcmlmaWVyKVxuICAgICkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBGaXJlYmFzZUF1dGhlbnRpY2F0aW9uV2ViLkVSUk9SX1JFQ0FQVENIQV9WRVJJRklFUl9NSVNTSU5HLFxuICAgICAgKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbmZpcm1hdGlvblJlc3VsdCA9IGF3YWl0IGxpbmtXaXRoUGhvbmVOdW1iZXIoXG4gICAgICAgIGN1cnJlbnRVc2VyLFxuICAgICAgICBvcHRpb25zLnBob25lTnVtYmVyLFxuICAgICAgICBvcHRpb25zLnJlY2FwdGNoYVZlcmlmaWVyLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IHsgdmVyaWZpY2F0aW9uSWQgfSA9IGNvbmZpcm1hdGlvblJlc3VsdDtcbiAgICAgIHRoaXMubGFzdENvbmZpcm1hdGlvblJlc3VsdC5zZXQodmVyaWZpY2F0aW9uSWQsIGNvbmZpcm1hdGlvblJlc3VsdCk7XG4gICAgICBjb25zdCBldmVudDogUGhvbmVDb2RlU2VudEV2ZW50ID0ge1xuICAgICAgICB2ZXJpZmljYXRpb25JZCxcbiAgICAgIH07XG4gICAgICB0aGlzLm5vdGlmeUxpc3RlbmVycyhcbiAgICAgICAgRmlyZWJhc2VBdXRoZW50aWNhdGlvbldlYi5QSE9ORV9DT0RFX1NFTlRfRVZFTlQsXG4gICAgICAgIGV2ZW50LFxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZXZlbnQ6IFBob25lVmVyaWZpY2F0aW9uRmFpbGVkRXZlbnQgPSB7XG4gICAgICAgIG1lc3NhZ2U6IHRoaXMuZ2V0RXJyb3JNZXNzYWdlKGVycm9yKSxcbiAgICAgIH07XG4gICAgICB0aGlzLm5vdGlmeUxpc3RlbmVycyhcbiAgICAgICAgRmlyZWJhc2VBdXRoZW50aWNhdGlvbldlYi5QSE9ORV9WRVJJRklDQVRJT05fRkFJTEVEX0VWRU5ULFxuICAgICAgICBldmVudCxcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGFzeW5jIGxpbmtXaXRoUGxheUdhbWVzKCk6IFByb21pc2U8TGlua1Jlc3VsdD4ge1xuICAgIHRocm93IG5ldyBFcnJvcignTm90IGF2YWlsYWJsZSBvbiB3ZWIuJyk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgbGlua1dpdGhUd2l0dGVyKFxuICAgIG9wdGlvbnM/OiBMaW5rV2l0aE9BdXRoT3B0aW9ucyxcbiAgKTogUHJvbWlzZTxMaW5rUmVzdWx0PiB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgVHdpdHRlckF1dGhQcm92aWRlcigpO1xuICAgIHRoaXMuYXBwbHlTaWduSW5PcHRpb25zKG9wdGlvbnMgfHwge30sIHByb3ZpZGVyKTtcbiAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHRoaXMubGlua0N1cnJlbnRVc2VyV2l0aFBvcHVwT3JSZWRpcmVjdChcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgb3B0aW9ucz8ubW9kZSxcbiAgICApO1xuICAgIGNvbnN0IGF1dGhDcmVkZW50aWFsID1cbiAgICAgIFR3aXR0ZXJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpO1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVNpZ25JblJlc3VsdCh1c2VyQ3JlZGVudGlhbCwgYXV0aENyZWRlbnRpYWwpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGxpbmtXaXRoWWFob28oXG4gICAgb3B0aW9ucz86IExpbmtXaXRoT0F1dGhPcHRpb25zLFxuICApOiBQcm9taXNlPExpbmtSZXN1bHQ+IHtcbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBPQXV0aFByb3ZpZGVyKFByb3ZpZGVySWQuWUFIT08pO1xuICAgIHRoaXMuYXBwbHlTaWduSW5PcHRpb25zKG9wdGlvbnMgfHwge30sIHByb3ZpZGVyKTtcbiAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHRoaXMubGlua0N1cnJlbnRVc2VyV2l0aFBvcHVwT3JSZWRpcmVjdChcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgb3B0aW9ucz8ubW9kZSxcbiAgICApO1xuICAgIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gT0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCk7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlU2lnbkluUmVzdWx0KHVzZXJDcmVkZW50aWFsLCBhdXRoQ3JlZGVudGlhbCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgcmVsb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGF1dGggPSBnZXRBdXRoKCk7XG4gICAgY29uc3QgY3VycmVudFVzZXIgPSBhdXRoLmN1cnJlbnRVc2VyO1xuICAgIGlmICghY3VycmVudFVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihGaXJlYmFzZUF1dGhlbnRpY2F0aW9uV2ViLkVSUk9SX05PX1VTRVJfU0lHTkVEX0lOKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlbG9hZChjdXJyZW50VXNlcik7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2VuZEVtYWlsVmVyaWZpY2F0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGF1dGggPSBnZXRBdXRoKCk7XG4gICAgY29uc3QgY3VycmVudFVzZXIgPSBhdXRoLmN1cnJlbnRVc2VyO1xuICAgIGlmICghY3VycmVudFVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihGaXJlYmFzZUF1dGhlbnRpY2F0aW9uV2ViLkVSUk9SX05PX1VTRVJfU0lHTkVEX0lOKTtcbiAgICB9XG4gICAgcmV0dXJuIHNlbmRFbWFpbFZlcmlmaWNhdGlvbihjdXJyZW50VXNlcik7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChcbiAgICBvcHRpb25zOiBTZW5kUGFzc3dvcmRSZXNldEVtYWlsT3B0aW9ucyxcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICByZXR1cm4gc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChhdXRoLCBvcHRpb25zLmVtYWlsKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBzZW5kU2lnbkluTGlua1RvRW1haWwoXG4gICAgb3B0aW9uczogU2VuZFNpZ25JbkxpbmtUb0VtYWlsT3B0aW9ucyxcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICByZXR1cm4gc2VuZFNpZ25JbkxpbmtUb0VtYWlsKFxuICAgICAgYXV0aCxcbiAgICAgIG9wdGlvbnMuZW1haWwsXG4gICAgICBvcHRpb25zLmFjdGlvbkNvZGVTZXR0aW5ncyxcbiAgICApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHNldExhbmd1YWdlQ29kZShvcHRpb25zOiBTZXRMYW5ndWFnZUNvZGVPcHRpb25zKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBhdXRoLmxhbmd1YWdlQ29kZSA9IG9wdGlvbnMubGFuZ3VhZ2VDb2RlO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHNldFBlcnNpc3RlbmNlKG9wdGlvbnM6IFNldFBlcnNpc3RlbmNlT3B0aW9ucyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGF1dGggPSBnZXRBdXRoKCk7XG4gICAgc3dpdGNoIChvcHRpb25zLnBlcnNpc3RlbmNlKSB7XG4gICAgICBjYXNlIFBlcnNpc3RlbmNlLkJyb3dzZXJMb2NhbDpcbiAgICAgICAgYXdhaXQgc2V0UGVyc2lzdGVuY2UoYXV0aCwgYnJvd3NlckxvY2FsUGVyc2lzdGVuY2UpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgUGVyc2lzdGVuY2UuQnJvd3NlclNlc3Npb246XG4gICAgICAgIGF3YWl0IHNldFBlcnNpc3RlbmNlKGF1dGgsIGJyb3dzZXJTZXNzaW9uUGVyc2lzdGVuY2UpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgUGVyc2lzdGVuY2UuSW5kZXhlZERiTG9jYWw6XG4gICAgICAgIGF3YWl0IHNldFBlcnNpc3RlbmNlKGF1dGgsIGluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2UpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgUGVyc2lzdGVuY2UuSW5NZW1vcnk6XG4gICAgICAgIGF3YWl0IHNldFBlcnNpc3RlbmNlKGF1dGgsIGluTWVtb3J5UGVyc2lzdGVuY2UpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2V0VGVuYW50SWQob3B0aW9uczogU2V0VGVuYW50SWRPcHRpb25zKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBhdXRoLnRlbmFudElkID0gb3B0aW9ucy50ZW5hbnRJZDtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBzaWduSW5Bbm9ueW1vdXNseSgpOiBQcm9taXNlPFNpZ25JblJlc3VsdD4ge1xuICAgIGNvbnN0IGF1dGggPSBnZXRBdXRoKCk7XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5Bbm9ueW1vdXNseShhdXRoKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTaWduSW5SZXN1bHQodXNlckNyZWRlbnRpYWwsIG51bGwpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHNpZ25JbldpdGhBcHBsZShcbiAgICBvcHRpb25zPzogU2lnbkluV2l0aE9BdXRoT3B0aW9ucyxcbiAgKTogUHJvbWlzZTxTaWduSW5SZXN1bHQ+IHtcbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBPQXV0aFByb3ZpZGVyKFByb3ZpZGVySWQuQVBQTEUpO1xuICAgIHRoaXMuYXBwbHlTaWduSW5PcHRpb25zKG9wdGlvbnMgfHwge30sIHByb3ZpZGVyKTtcbiAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHRoaXMuc2lnbkluV2l0aFBvcHVwT3JSZWRpcmVjdChcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgb3B0aW9ucz8ubW9kZSxcbiAgICApO1xuICAgIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gT0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCk7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlU2lnbkluUmVzdWx0KHVzZXJDcmVkZW50aWFsLCBhdXRoQ3JlZGVudGlhbCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2lnbkluV2l0aEN1c3RvbVRva2VuKFxuICAgIG9wdGlvbnM6IFNpZ25JbldpdGhDdXN0b21Ub2tlbk9wdGlvbnMsXG4gICk6IFByb21pc2U8U2lnbkluUmVzdWx0PiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHNpZ25JbldpdGhDdXN0b21Ub2tlbihhdXRoLCBvcHRpb25zLnRva2VuKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTaWduSW5SZXN1bHQodXNlckNyZWRlbnRpYWwsIG51bGwpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKFxuICAgIG9wdGlvbnM6IFNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkT3B0aW9ucyxcbiAgKTogUHJvbWlzZTxTaWduSW5SZXN1bHQ+IHtcbiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpO1xuICAgIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQoXG4gICAgICBhdXRoLFxuICAgICAgb3B0aW9ucy5lbWFpbCxcbiAgICAgIG9wdGlvbnMucGFzc3dvcmQsXG4gICAgKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTaWduSW5SZXN1bHQodXNlckNyZWRlbnRpYWwsIG51bGwpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHNpZ25JbldpdGhFbWFpbExpbmsoXG4gICAgb3B0aW9uczogU2lnbkluV2l0aEVtYWlsTGlua09wdGlvbnMsXG4gICk6IFByb21pc2U8U2lnbkluUmVzdWx0PiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHNpZ25JbldpdGhFbWFpbExpbmsoXG4gICAgICBhdXRoLFxuICAgICAgb3B0aW9ucy5lbWFpbCxcbiAgICAgIG9wdGlvbnMuZW1haWxMaW5rLFxuICAgICk7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlU2lnbkluUmVzdWx0KHVzZXJDcmVkZW50aWFsLCBudWxsKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBzaWduSW5XaXRoRmFjZWJvb2soXG4gICAgb3B0aW9ucz86IFNpZ25JbldpdGhPQXV0aE9wdGlvbnMsXG4gICk6IFByb21pc2U8U2lnbkluUmVzdWx0PiB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcbiAgICB0aGlzLmFwcGx5U2lnbkluT3B0aW9ucyhvcHRpb25zIHx8IHt9LCBwcm92aWRlcik7XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCB0aGlzLnNpZ25JbldpdGhQb3B1cE9yUmVkaXJlY3QoXG4gICAgICBwcm92aWRlcixcbiAgICAgIG9wdGlvbnM/Lm1vZGUsXG4gICAgKTtcbiAgICBjb25zdCBhdXRoQ3JlZGVudGlhbCA9XG4gICAgICBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCk7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlU2lnbkluUmVzdWx0KHVzZXJDcmVkZW50aWFsLCBhdXRoQ3JlZGVudGlhbCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2lnbkluV2l0aEdpdGh1YihcbiAgICBvcHRpb25zPzogU2lnbkluV2l0aE9BdXRoT3B0aW9ucyxcbiAgKTogUHJvbWlzZTxTaWduSW5SZXN1bHQ+IHtcbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBHaXRodWJBdXRoUHJvdmlkZXIoKTtcbiAgICB0aGlzLmFwcGx5U2lnbkluT3B0aW9ucyhvcHRpb25zIHx8IHt9LCBwcm92aWRlcik7XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCB0aGlzLnNpZ25JbldpdGhQb3B1cE9yUmVkaXJlY3QoXG4gICAgICBwcm92aWRlcixcbiAgICAgIG9wdGlvbnM/Lm1vZGUsXG4gICAgKTtcbiAgICBjb25zdCBhdXRoQ3JlZGVudGlhbCA9XG4gICAgICBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpO1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVNpZ25JblJlc3VsdCh1c2VyQ3JlZGVudGlhbCwgYXV0aENyZWRlbnRpYWwpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHNpZ25JbldpdGhHb29nbGUoXG4gICAgb3B0aW9ucz86IFNpZ25JbldpdGhPQXV0aE9wdGlvbnMsXG4gICk6IFByb21pc2U8U2lnbkluUmVzdWx0PiB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgR29vZ2xlQXV0aFByb3ZpZGVyKCk7XG4gICAgdGhpcy5hcHBseVNpZ25Jbk9wdGlvbnMob3B0aW9ucyB8fCB7fSwgcHJvdmlkZXIpO1xuICAgIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgdGhpcy5zaWduSW5XaXRoUG9wdXBPclJlZGlyZWN0KFxuICAgICAgcHJvdmlkZXIsXG4gICAgICBvcHRpb25zPy5tb2RlLFxuICAgICk7XG4gICAgY29uc3QgYXV0aENyZWRlbnRpYWwgPVxuICAgICAgR29vZ2xlQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTaWduSW5SZXN1bHQodXNlckNyZWRlbnRpYWwsIGF1dGhDcmVkZW50aWFsKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBzaWduSW5XaXRoTWljcm9zb2Z0KFxuICAgIG9wdGlvbnM/OiBTaWduSW5XaXRoT0F1dGhPcHRpb25zLFxuICApOiBQcm9taXNlPFNpZ25JblJlc3VsdD4ge1xuICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IE9BdXRoUHJvdmlkZXIoUHJvdmlkZXJJZC5NSUNST1NPRlQpO1xuICAgIHRoaXMuYXBwbHlTaWduSW5PcHRpb25zKG9wdGlvbnMgfHwge30sIHByb3ZpZGVyKTtcbiAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHRoaXMuc2lnbkluV2l0aFBvcHVwT3JSZWRpcmVjdChcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgb3B0aW9ucz8ubW9kZSxcbiAgICApO1xuICAgIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gT0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCk7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlU2lnbkluUmVzdWx0KHVzZXJDcmVkZW50aWFsLCBhdXRoQ3JlZGVudGlhbCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2lnbkluV2l0aFBob25lTnVtYmVyKFxuICAgIG9wdGlvbnM6IFNpZ25JbldpdGhQaG9uZU51bWJlck9wdGlvbnMsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghb3B0aW9ucy5waG9uZU51bWJlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKEZpcmViYXNlQXV0aGVudGljYXRpb25XZWIuRVJST1JfUEhPTkVfTlVNQkVSX01JU1NJTkcpO1xuICAgIH1cbiAgICBpZiAoXG4gICAgICAhb3B0aW9ucy5yZWNhcHRjaGFWZXJpZmllciB8fFxuICAgICAgIShvcHRpb25zLnJlY2FwdGNoYVZlcmlmaWVyIGluc3RhbmNlb2YgUmVjYXB0Y2hhVmVyaWZpZXIpXG4gICAgKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIEZpcmViYXNlQXV0aGVudGljYXRpb25XZWIuRVJST1JfUkVDQVBUQ0hBX1ZFUklGSUVSX01JU1NJTkcsXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb25maXJtYXRpb25SZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUGhvbmVOdW1iZXIoXG4gICAgICAgIGF1dGgsXG4gICAgICAgIG9wdGlvbnMucGhvbmVOdW1iZXIsXG4gICAgICAgIG9wdGlvbnMucmVjYXB0Y2hhVmVyaWZpZXIsXG4gICAgICApO1xuICAgICAgY29uc3QgeyB2ZXJpZmljYXRpb25JZCB9ID0gY29uZmlybWF0aW9uUmVzdWx0O1xuICAgICAgdGhpcy5sYXN0Q29uZmlybWF0aW9uUmVzdWx0LnNldCh2ZXJpZmljYXRpb25JZCwgY29uZmlybWF0aW9uUmVzdWx0KTtcbiAgICAgIGNvbnN0IGV2ZW50OiBQaG9uZUNvZGVTZW50RXZlbnQgPSB7XG4gICAgICAgIHZlcmlmaWNhdGlvbklkLFxuICAgICAgfTtcbiAgICAgIHRoaXMubm90aWZ5TGlzdGVuZXJzKFxuICAgICAgICBGaXJlYmFzZUF1dGhlbnRpY2F0aW9uV2ViLlBIT05FX0NPREVfU0VOVF9FVkVOVCxcbiAgICAgICAgZXZlbnQsXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBldmVudDogUGhvbmVWZXJpZmljYXRpb25GYWlsZWRFdmVudCA9IHtcbiAgICAgICAgbWVzc2FnZTogdGhpcy5nZXRFcnJvck1lc3NhZ2UoZXJyb3IpLFxuICAgICAgfTtcbiAgICAgIHRoaXMubm90aWZ5TGlzdGVuZXJzKFxuICAgICAgICBGaXJlYmFzZUF1dGhlbnRpY2F0aW9uV2ViLlBIT05FX1ZFUklGSUNBVElPTl9GQUlMRURfRVZFTlQsXG4gICAgICAgIGV2ZW50LFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2lnbkluV2l0aFBsYXlHYW1lcygpOiBQcm9taXNlPFNpZ25JblJlc3VsdD4ge1xuICAgIHRocm93IG5ldyBFcnJvcignTm90IGF2YWlsYWJsZSBvbiB3ZWIuJyk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2lnbkluV2l0aEdhbWVDZW50ZXIoKTogUHJvbWlzZTxTaWduSW5SZXN1bHQ+IHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vdCBhdmFpbGFibGUgb24gd2ViLicpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHNpZ25JbldpdGhUd2l0dGVyKFxuICAgIG9wdGlvbnM/OiBTaWduSW5XaXRoT0F1dGhPcHRpb25zLFxuICApOiBQcm9taXNlPFNpZ25JblJlc3VsdD4ge1xuICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IFR3aXR0ZXJBdXRoUHJvdmlkZXIoKTtcbiAgICB0aGlzLmFwcGx5U2lnbkluT3B0aW9ucyhvcHRpb25zIHx8IHt9LCBwcm92aWRlcik7XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCB0aGlzLnNpZ25JbldpdGhQb3B1cE9yUmVkaXJlY3QoXG4gICAgICBwcm92aWRlcixcbiAgICAgIG9wdGlvbnM/Lm1vZGUsXG4gICAgKTtcbiAgICBjb25zdCBhdXRoQ3JlZGVudGlhbCA9XG4gICAgICBUd2l0dGVyQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKTtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTaWduSW5SZXN1bHQodXNlckNyZWRlbnRpYWwsIGF1dGhDcmVkZW50aWFsKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBzaWduSW5XaXRoWWFob28oXG4gICAgb3B0aW9ucz86IFNpZ25JbldpdGhPQXV0aE9wdGlvbnMsXG4gICk6IFByb21pc2U8U2lnbkluUmVzdWx0PiB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgT0F1dGhQcm92aWRlcihQcm92aWRlcklkLllBSE9PKTtcbiAgICB0aGlzLmFwcGx5U2lnbkluT3B0aW9ucyhvcHRpb25zIHx8IHt9LCBwcm92aWRlcik7XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCB0aGlzLnNpZ25JbldpdGhQb3B1cE9yUmVkaXJlY3QoXG4gICAgICBwcm92aWRlcixcbiAgICAgIG9wdGlvbnM/Lm1vZGUsXG4gICAgKTtcbiAgICBjb25zdCBhdXRoQ3JlZGVudGlhbCA9IE9BdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpO1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVNpZ25JblJlc3VsdCh1c2VyQ3JlZGVudGlhbCwgYXV0aENyZWRlbnRpYWwpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHNpZ25PdXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBhd2FpdCBhdXRoLnNpZ25PdXQoKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyB1bmxpbmsob3B0aW9uczogVW5saW5rT3B0aW9ucyk6IFByb21pc2U8VW5saW5rUmVzdWx0PiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBpZiAoIWF1dGguY3VycmVudFVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihGaXJlYmFzZUF1dGhlbnRpY2F0aW9uV2ViLkVSUk9SX05PX1VTRVJfU0lHTkVEX0lOKTtcbiAgICB9XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHVubGluayhhdXRoLmN1cnJlbnRVc2VyLCBvcHRpb25zLnByb3ZpZGVySWQpO1xuICAgIGNvbnN0IHVzZXJSZXN1bHQgPSB0aGlzLmNyZWF0ZVVzZXJSZXN1bHQodXNlcik7XG4gICAgY29uc3QgcmVzdWx0OiBVbmxpbmtSZXN1bHQgPSB7XG4gICAgICB1c2VyOiB1c2VyUmVzdWx0LFxuICAgIH07XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyB1cGRhdGVFbWFpbChvcHRpb25zOiBVcGRhdGVFbWFpbE9wdGlvbnMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpO1xuICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gYXV0aC5jdXJyZW50VXNlcjtcbiAgICBpZiAoIWN1cnJlbnRVc2VyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoRmlyZWJhc2VBdXRoZW50aWNhdGlvbldlYi5FUlJPUl9OT19VU0VSX1NJR05FRF9JTik7XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGVFbWFpbChjdXJyZW50VXNlciwgb3B0aW9ucy5uZXdFbWFpbCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgdXBkYXRlUGFzc3dvcmQob3B0aW9uczogVXBkYXRlUGFzc3dvcmRPcHRpb25zKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBjb25zdCBjdXJyZW50VXNlciA9IGF1dGguY3VycmVudFVzZXI7XG4gICAgaWYgKCFjdXJyZW50VXNlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKEZpcmViYXNlQXV0aGVudGljYXRpb25XZWIuRVJST1JfTk9fVVNFUl9TSUdORURfSU4pO1xuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlUGFzc3dvcmQoY3VycmVudFVzZXIsIG9wdGlvbnMubmV3UGFzc3dvcmQpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHVwZGF0ZVByb2ZpbGUob3B0aW9uczogVXBkYXRlUHJvZmlsZU9wdGlvbnMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpO1xuICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gYXV0aC5jdXJyZW50VXNlcjtcbiAgICBpZiAoIWN1cnJlbnRVc2VyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoRmlyZWJhc2VBdXRoZW50aWNhdGlvbldlYi5FUlJPUl9OT19VU0VSX1NJR05FRF9JTik7XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGVQcm9maWxlKGN1cnJlbnRVc2VyLCBvcHRpb25zKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyB1c2VBcHBMYW5ndWFnZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpO1xuICAgIGF1dGgudXNlRGV2aWNlTGFuZ3VhZ2UoKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyB1c2VFbXVsYXRvcihvcHRpb25zOiBVc2VFbXVsYXRvck9wdGlvbnMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpO1xuICAgIGNvbnN0IHBvcnQgPSBvcHRpb25zLnBvcnQgfHwgOTA5OTtcbiAgICBjb25zdCBzY2hlbWUgPSBvcHRpb25zLnNjaGVtZSB8fCAnaHR0cCc7XG4gICAgaWYgKG9wdGlvbnMuaG9zdC5pbmNsdWRlcygnOi8vJykpIHtcbiAgICAgIGNvbm5lY3RBdXRoRW11bGF0b3IoYXV0aCwgYCR7b3B0aW9ucy5ob3N0fToke3BvcnR9YCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbm5lY3RBdXRoRW11bGF0b3IoYXV0aCwgYCR7c2NoZW1lfTovLyR7b3B0aW9ucy5ob3N0fToke3BvcnR9YCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVBdXRoU3RhdGVDaGFuZ2UodXNlcjogRmlyZWJhc2VVc2VyIHwgbnVsbCk6IHZvaWQge1xuICAgIGNvbnN0IHVzZXJSZXN1bHQgPSB0aGlzLmNyZWF0ZVVzZXJSZXN1bHQodXNlcik7XG4gICAgY29uc3QgY2hhbmdlOiBBdXRoU3RhdGVDaGFuZ2UgPSB7XG4gICAgICB1c2VyOiB1c2VyUmVzdWx0LFxuICAgIH07XG4gICAgdGhpcy5ub3RpZnlMaXN0ZW5lcnMoXG4gICAgICBGaXJlYmFzZUF1dGhlbnRpY2F0aW9uV2ViLkFVVEhfU1RBVEVfQ0hBTkdFX0VWRU5ULFxuICAgICAgY2hhbmdlLFxuICAgICk7XG4gIH1cblxuICBwcml2YXRlIGFwcGx5U2lnbkluT3B0aW9ucyhcbiAgICBvcHRpb25zOiBTaWduSW5XaXRoT0F1dGhPcHRpb25zLFxuICAgIHByb3ZpZGVyOiBPQXV0aFByb3ZpZGVyIHwgR29vZ2xlQXV0aFByb3ZpZGVyIHwgRmFjZWJvb2tBdXRoUHJvdmlkZXIsXG4gICkge1xuICAgIGlmIChvcHRpb25zLmN1c3RvbVBhcmFtZXRlcnMpIHtcbiAgICAgIGNvbnN0IGN1c3RvbVBhcmFtZXRlcnM6IEZpcmViYXNlQ3VzdG9tUGFyYW1ldGVycyA9IHt9O1xuICAgICAgb3B0aW9ucy5jdXN0b21QYXJhbWV0ZXJzLm1hcChwYXJhbWV0ZXIgPT4ge1xuICAgICAgICBjdXN0b21QYXJhbWV0ZXJzW3BhcmFtZXRlci5rZXldID0gcGFyYW1ldGVyLnZhbHVlO1xuICAgICAgfSk7XG4gICAgICBwcm92aWRlci5zZXRDdXN0b21QYXJhbWV0ZXJzKGN1c3RvbVBhcmFtZXRlcnMpO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy5zY29wZXMpIHtcbiAgICAgIGZvciAoY29uc3Qgc2NvcGUgb2Ygb3B0aW9ucy5zY29wZXMpIHtcbiAgICAgICAgcHJvdmlkZXIuYWRkU2NvcGUoc2NvcGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzaWduSW5XaXRoUG9wdXBPclJlZGlyZWN0KFxuICAgIHByb3ZpZGVyOiBGaXJlYmFzZUF1dGhQcm92aWRlcixcbiAgICBtb2RlPzogJ3BvcHVwJyB8ICdyZWRpcmVjdCcsXG4gICk6IFByb21pc2U8RmlyZWJhc2VVc2VyQ3JlZGVudGlhbCB8IG5ldmVyPiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBpZiAobW9kZSA9PT0gJ3JlZGlyZWN0Jykge1xuICAgICAgcmV0dXJuIHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBsaW5rQ3VycmVudFVzZXJXaXRoUG9wdXBPclJlZGlyZWN0KFxuICAgIHByb3ZpZGVyOiBGaXJlYmFzZUF1dGhQcm92aWRlcixcbiAgICBtb2RlPzogJ3BvcHVwJyB8ICdyZWRpcmVjdCcsXG4gICk6IFByb21pc2U8RmlyZWJhc2VVc2VyQ3JlZGVudGlhbCB8IG5ldmVyPiB7XG4gICAgY29uc3QgYXV0aCA9IGdldEF1dGgoKTtcbiAgICBpZiAoIWF1dGguY3VycmVudFVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihGaXJlYmFzZUF1dGhlbnRpY2F0aW9uV2ViLkVSUk9SX05PX1VTRVJfU0lHTkVEX0lOKTtcbiAgICB9XG4gICAgaWYgKG1vZGUgPT09ICdyZWRpcmVjdCcpIHtcbiAgICAgIHJldHVybiBsaW5rV2l0aFJlZGlyZWN0KGF1dGguY3VycmVudFVzZXIsIHByb3ZpZGVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGxpbmtXaXRoUG9wdXAoYXV0aC5jdXJyZW50VXNlciwgcHJvdmlkZXIpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBsaW5rQ3VycmVudFVzZXJXaXRoQ3JlZGVudGlhbChcbiAgICBjcmVkZW50aWFsOiBGaXJlYmFzZUF1dGhDcmVkZW50aWFsLFxuICApOiBQcm9taXNlPEZpcmViYXNlVXNlckNyZWRlbnRpYWw+IHtcbiAgICBjb25zdCBhdXRoID0gZ2V0QXV0aCgpO1xuICAgIGlmICghYXV0aC5jdXJyZW50VXNlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKEZpcmViYXNlQXV0aGVudGljYXRpb25XZWIuRVJST1JfTk9fVVNFUl9TSUdORURfSU4pO1xuICAgIH1cbiAgICByZXR1cm4gbGlua1dpdGhDcmVkZW50aWFsKGF1dGguY3VycmVudFVzZXIsIGNyZWRlbnRpYWwpO1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVTaWduSW5SZXN1bHQoXG4gICAgdXNlckNyZWRlbnRpYWw6IEZpcmViYXNlVXNlckNyZWRlbnRpYWwgfCBudWxsLFxuICAgIGF1dGhDcmVkZW50aWFsOiBGaXJlYmFzZUF1dGhDcmVkZW50aWFsIHwgbnVsbCxcbiAgKTogU2lnbkluUmVzdWx0IHtcbiAgICBjb25zdCB1c2VyUmVzdWx0ID0gdGhpcy5jcmVhdGVVc2VyUmVzdWx0KHVzZXJDcmVkZW50aWFsPy51c2VyIHx8IG51bGwpO1xuICAgIGNvbnN0IGNyZWRlbnRpYWxSZXN1bHQgPSB0aGlzLmNyZWF0ZUNyZWRlbnRpYWxSZXN1bHQoYXV0aENyZWRlbnRpYWwpO1xuICAgIGNvbnN0IGFkZGl0aW9uYWxVc2VySW5mb1Jlc3VsdCA9XG4gICAgICB0aGlzLmNyZWF0ZUFkZGl0aW9uYWxVc2VySW5mb1Jlc3VsdCh1c2VyQ3JlZGVudGlhbCk7XG4gICAgY29uc3QgcmVzdWx0OiBTaWduSW5SZXN1bHQgPSB7XG4gICAgICB1c2VyOiB1c2VyUmVzdWx0LFxuICAgICAgY3JlZGVudGlhbDogY3JlZGVudGlhbFJlc3VsdCxcbiAgICAgIGFkZGl0aW9uYWxVc2VySW5mbzogYWRkaXRpb25hbFVzZXJJbmZvUmVzdWx0LFxuICAgIH07XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlQ3JlZGVudGlhbFJlc3VsdChcbiAgICBjcmVkZW50aWFsOiBGaXJlYmFzZUF1dGhDcmVkZW50aWFsIHwgbnVsbCxcbiAgKTogQXV0aENyZWRlbnRpYWwgfCBudWxsIHtcbiAgICBpZiAoIWNyZWRlbnRpYWwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCByZXN1bHQ6IEF1dGhDcmVkZW50aWFsID0ge1xuICAgICAgcHJvdmlkZXJJZDogY3JlZGVudGlhbC5wcm92aWRlcklkLFxuICAgIH07XG4gICAgaWYgKGNyZWRlbnRpYWwgaW5zdGFuY2VvZiBPQXV0aENyZWRlbnRpYWwpIHtcbiAgICAgIHJlc3VsdC5hY2Nlc3NUb2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gICAgICByZXN1bHQuaWRUb2tlbiA9IGNyZWRlbnRpYWwuaWRUb2tlbjtcbiAgICAgIHJlc3VsdC5zZWNyZXQgPSBjcmVkZW50aWFsLnNlY3JldDtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlVXNlclJlc3VsdCh1c2VyOiBGaXJlYmFzZVVzZXIgfCBudWxsKTogVXNlciB8IG51bGwge1xuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdDogVXNlciA9IHtcbiAgICAgIGRpc3BsYXlOYW1lOiB1c2VyLmRpc3BsYXlOYW1lLFxuICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICBlbWFpbFZlcmlmaWVkOiB1c2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICBpc0Fub255bW91czogdXNlci5pc0Fub255bW91cyxcbiAgICAgIG1ldGFkYXRhOiB0aGlzLmNyZWF0ZVVzZXJNZXRhZGF0YVJlc3VsdCh1c2VyLm1ldGFkYXRhKSxcbiAgICAgIHBob25lTnVtYmVyOiB1c2VyLnBob25lTnVtYmVyLFxuICAgICAgcGhvdG9Vcmw6IHVzZXIucGhvdG9VUkwsXG4gICAgICBwcm92aWRlckRhdGE6IHRoaXMuY3JlYXRlVXNlclByb3ZpZGVyRGF0YVJlc3VsdCh1c2VyLnByb3ZpZGVyRGF0YSksXG4gICAgICBwcm92aWRlcklkOiB1c2VyLnByb3ZpZGVySWQsXG4gICAgICB0ZW5hbnRJZDogdXNlci50ZW5hbnRJZCxcbiAgICAgIHVpZDogdXNlci51aWQsXG4gICAgfTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVVc2VyTWV0YWRhdGFSZXN1bHQoXG4gICAgbWV0YWRhdGE6IEZpcmViYXNlVXNlck1lYXRkYXRhLFxuICApOiBVc2VyTWV0YWRhdGEge1xuICAgIGNvbnN0IHJlc3VsdDogVXNlck1ldGFkYXRhID0ge307XG4gICAgaWYgKG1ldGFkYXRhLmNyZWF0aW9uVGltZSkge1xuICAgICAgcmVzdWx0LmNyZWF0aW9uVGltZSA9IERhdGUucGFyc2UobWV0YWRhdGEuY3JlYXRpb25UaW1lKTtcbiAgICB9XG4gICAgaWYgKG1ldGFkYXRhLmxhc3RTaWduSW5UaW1lKSB7XG4gICAgICByZXN1bHQubGFzdFNpZ25JblRpbWUgPSBEYXRlLnBhcnNlKG1ldGFkYXRhLmxhc3RTaWduSW5UaW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlVXNlclByb3ZpZGVyRGF0YVJlc3VsdChcbiAgICBwcm92aWRlckRhdGE6IEZpcmViYXNlVXNlckluZm9bXSxcbiAgKTogVXNlckluZm9bXSB7XG4gICAgcmV0dXJuIHByb3ZpZGVyRGF0YS5tYXAoZGF0YSA9PiAoe1xuICAgICAgZGlzcGxheU5hbWU6IGRhdGEuZGlzcGxheU5hbWUsXG4gICAgICBlbWFpbDogZGF0YS5lbWFpbCxcbiAgICAgIHBob25lTnVtYmVyOiBkYXRhLnBob25lTnVtYmVyLFxuICAgICAgcGhvdG9Vcmw6IGRhdGEucGhvdG9VUkwsXG4gICAgICBwcm92aWRlcklkOiBkYXRhLnByb3ZpZGVySWQsXG4gICAgICB1aWQ6IGRhdGEudWlkLFxuICAgIH0pKTtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlQWRkaXRpb25hbFVzZXJJbmZvUmVzdWx0KFxuICAgIGNyZWRlbnRpYWw6IEZpcmViYXNlVXNlckNyZWRlbnRpYWwgfCBudWxsLFxuICApOiBBZGRpdGlvbmFsVXNlckluZm8gfCBudWxsIHtcbiAgICBpZiAoIWNyZWRlbnRpYWwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBhZGRpdGlvbmFsVXNlckluZm8gPSBnZXRBZGRpdGlvbmFsVXNlckluZm8oY3JlZGVudGlhbCk7XG4gICAgaWYgKCFhZGRpdGlvbmFsVXNlckluZm8pIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCB7IGlzTmV3VXNlciwgcHJvZmlsZSwgcHJvdmlkZXJJZCwgdXNlcm5hbWUgfSA9IGFkZGl0aW9uYWxVc2VySW5mbztcbiAgICBjb25zdCByZXN1bHQ6IEFkZGl0aW9uYWxVc2VySW5mbyA9IHtcbiAgICAgIGlzTmV3VXNlcixcbiAgICB9O1xuICAgIGlmIChwcm92aWRlcklkICE9PSBudWxsKSB7XG4gICAgICByZXN1bHQucHJvdmlkZXJJZCA9IHByb3ZpZGVySWQ7XG4gICAgfVxuICAgIGlmIChwcm9maWxlICE9PSBudWxsKSB7XG4gICAgICByZXN1bHQucHJvZmlsZSA9IHByb2ZpbGUgYXMgeyBba2V5OiBzdHJpbmddOiB1bmtub3duIH07XG4gICAgfVxuICAgIGlmICh1c2VybmFtZSAhPT0gbnVsbCAmJiB1c2VybmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXN1bHQudXNlcm5hbWUgPSB1c2VybmFtZTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RXJyb3JNZXNzYWdlKGVycm9yOiB1bmtub3duKTogc3RyaW5nIHtcbiAgICBpZiAoXG4gICAgICBlcnJvciBpbnN0YW5jZW9mIE9iamVjdCAmJlxuICAgICAgJ21lc3NhZ2UnIGluIGVycm9yICYmXG4gICAgICB0eXBlb2YgZXJyb3JbJ21lc3NhZ2UnXSA9PT0gJ3N0cmluZydcbiAgICApIHtcbiAgICAgIHJldHVybiBlcnJvclsnbWVzc2FnZSddO1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZXJyb3IpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiRmlyZWJhc2VBdXRoZW50aWNhdGlvbldlYiIsIldlYlBsdWdpbiIsImNvbnN0cnVjdG9yIiwic3VwZXIiLCJsYXN0Q29uZmlybWF0aW9uUmVzdWx0IiwiTWFwIiwiZ2V0QXV0aCIsIm9uQXV0aFN0YXRlQ2hhbmdlZCIsInVzZXIiLCJ0aGlzIiwiaGFuZGxlQXV0aFN0YXRlQ2hhbmdlIiwiYXBwbHlBY3Rpb25Db2RlIiwib3B0aW9ucyIsImF1dGgiLCJvb2JDb2RlIiwiY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkIiwidXNlckNyZWRlbnRpYWwiLCJlbWFpbCIsInBhc3N3b3JkIiwiY3JlYXRlU2lnbkluUmVzdWx0IiwiY29uZmlybVBhc3N3b3JkUmVzZXQiLCJuZXdQYXNzd29yZCIsImNvbmZpcm1WZXJpZmljYXRpb25Db2RlIiwidmVyaWZpY2F0aW9uQ29kZSIsInZlcmlmaWNhdGlvbklkIiwiY29uZmlybWF0aW9uUmVzdWx0IiwiZ2V0IiwiRXJyb3IiLCJFUlJPUl9DT05GSVJNQVRJT05fUkVTVUxUX01JU1NJTkciLCJjb25maXJtIiwiZGVsZXRlVXNlciIsImN1cnJlbnRVc2VyIiwiRVJST1JfTk9fVVNFUl9TSUdORURfSU4iLCJnZXRDdXJyZW50VXNlciIsImNyZWF0ZVVzZXJSZXN1bHQiLCJnZXRJZFRva2VuIiwidG9rZW4iLCJmb3JjZVJlZnJlc2giLCJnZXRSZWRpcmVjdFJlc3VsdCIsImF1dGhDcmVkZW50aWFsIiwiT0F1dGhQcm92aWRlciIsImNyZWRlbnRpYWxGcm9tUmVzdWx0IiwiZ2V0VGVuYW50SWQiLCJ0ZW5hbnRJZCIsImlzU2lnbkluV2l0aEVtYWlsTGluayIsImVtYWlsTGluayIsImxpbmtXaXRoQXBwbGUiLCJwcm92aWRlciIsIlByb3ZpZGVySWQiLCJBUFBMRSIsImFwcGx5U2lnbkluT3B0aW9ucyIsImxpbmtDdXJyZW50VXNlcldpdGhQb3B1cE9yUmVkaXJlY3QiLCJtb2RlIiwibGlua1dpdGhFbWFpbEFuZFBhc3N3b3JkIiwiRW1haWxBdXRoUHJvdmlkZXIiLCJjcmVkZW50aWFsIiwibGlua0N1cnJlbnRVc2VyV2l0aENyZWRlbnRpYWwiLCJsaW5rV2l0aEVtYWlsTGluayIsImNyZWRlbnRpYWxXaXRoTGluayIsImxpbmtXaXRoRmFjZWJvb2siLCJGYWNlYm9va0F1dGhQcm92aWRlciIsImxpbmtXaXRoR2FtZUNlbnRlciIsImxpbmtXaXRoR2l0aHViIiwiR2l0aHViQXV0aFByb3ZpZGVyIiwibGlua1dpdGhHb29nbGUiLCJHb29nbGVBdXRoUHJvdmlkZXIiLCJsaW5rV2l0aE1pY3Jvc29mdCIsIk1JQ1JPU09GVCIsImxpbmtXaXRoUGhvbmVOdW1iZXIiLCJwaG9uZU51bWJlciIsIkVSUk9SX1BIT05FX05VTUJFUl9NSVNTSU5HIiwicmVjYXB0Y2hhVmVyaWZpZXIiLCJSZWNhcHRjaGFWZXJpZmllciIsIkVSUk9SX1JFQ0FQVENIQV9WRVJJRklFUl9NSVNTSU5HIiwic2V0IiwiZXZlbnQiLCJub3RpZnlMaXN0ZW5lcnMiLCJQSE9ORV9DT0RFX1NFTlRfRVZFTlQiLCJlcnJvciIsIm1lc3NhZ2UiLCJnZXRFcnJvck1lc3NhZ2UiLCJQSE9ORV9WRVJJRklDQVRJT05fRkFJTEVEX0VWRU5UIiwibGlua1dpdGhQbGF5R2FtZXMiLCJsaW5rV2l0aFR3aXR0ZXIiLCJUd2l0dGVyQXV0aFByb3ZpZGVyIiwibGlua1dpdGhZYWhvbyIsIllBSE9PIiwicmVsb2FkIiwic2VuZEVtYWlsVmVyaWZpY2F0aW9uIiwic2VuZFBhc3N3b3JkUmVzZXRFbWFpbCIsInNlbmRTaWduSW5MaW5rVG9FbWFpbCIsImFjdGlvbkNvZGVTZXR0aW5ncyIsInNldExhbmd1YWdlQ29kZSIsImxhbmd1YWdlQ29kZSIsInNldFBlcnNpc3RlbmNlIiwicGVyc2lzdGVuY2UiLCJQZXJzaXN0ZW5jZSIsIkJyb3dzZXJMb2NhbCIsImJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlIiwiQnJvd3NlclNlc3Npb24iLCJicm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlIiwiSW5kZXhlZERiTG9jYWwiLCJpbmRleGVkREJMb2NhbFBlcnNpc3RlbmNlIiwiSW5NZW1vcnkiLCJpbk1lbW9yeVBlcnNpc3RlbmNlIiwic2V0VGVuYW50SWQiLCJzaWduSW5Bbm9ueW1vdXNseSIsInNpZ25JbldpdGhBcHBsZSIsInNpZ25JbldpdGhQb3B1cE9yUmVkaXJlY3QiLCJzaWduSW5XaXRoQ3VzdG9tVG9rZW4iLCJzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZCIsInNpZ25JbldpdGhFbWFpbExpbmsiLCJzaWduSW5XaXRoRmFjZWJvb2siLCJzaWduSW5XaXRoR2l0aHViIiwic2lnbkluV2l0aEdvb2dsZSIsInNpZ25JbldpdGhNaWNyb3NvZnQiLCJzaWduSW5XaXRoUGhvbmVOdW1iZXIiLCJzaWduSW5XaXRoUGxheUdhbWVzIiwic2lnbkluV2l0aEdhbWVDZW50ZXIiLCJzaWduSW5XaXRoVHdpdHRlciIsInNpZ25JbldpdGhZYWhvbyIsInNpZ25PdXQiLCJ1bmxpbmsiLCJwcm92aWRlcklkIiwidXBkYXRlRW1haWwiLCJuZXdFbWFpbCIsInVwZGF0ZVBhc3N3b3JkIiwidXBkYXRlUHJvZmlsZSIsInVzZUFwcExhbmd1YWdlIiwidXNlRGV2aWNlTGFuZ3VhZ2UiLCJ1c2VFbXVsYXRvciIsInBvcnQiLCJzY2hlbWUiLCJob3N0IiwiaW5jbHVkZXMiLCJjb25uZWN0QXV0aEVtdWxhdG9yIiwiY2hhbmdlIiwiQVVUSF9TVEFURV9DSEFOR0VfRVZFTlQiLCJjdXN0b21QYXJhbWV0ZXJzIiwibWFwIiwicGFyYW1ldGVyIiwia2V5IiwidmFsdWUiLCJzZXRDdXN0b21QYXJhbWV0ZXJzIiwic2NvcGVzIiwic2NvcGUiLCJhZGRTY29wZSIsInNpZ25JbldpdGhSZWRpcmVjdCIsInNpZ25JbldpdGhQb3B1cCIsImxpbmtXaXRoUmVkaXJlY3QiLCJsaW5rV2l0aFBvcHVwIiwibGlua1dpdGhDcmVkZW50aWFsIiwiY3JlYXRlQ3JlZGVudGlhbFJlc3VsdCIsImFkZGl0aW9uYWxVc2VySW5mbyIsImNyZWF0ZUFkZGl0aW9uYWxVc2VySW5mb1Jlc3VsdCIsInJlc3VsdCIsIk9BdXRoQ3JlZGVudGlhbCIsImFjY2Vzc1Rva2VuIiwiaWRUb2tlbiIsInNlY3JldCIsImRpc3BsYXlOYW1lIiwiZW1haWxWZXJpZmllZCIsImlzQW5vbnltb3VzIiwibWV0YWRhdGEiLCJjcmVhdGVVc2VyTWV0YWRhdGFSZXN1bHQiLCJwaG90b1VybCIsInBob3RvVVJMIiwicHJvdmlkZXJEYXRhIiwiY3JlYXRlVXNlclByb3ZpZGVyRGF0YVJlc3VsdCIsInVpZCIsImNyZWF0aW9uVGltZSIsIkRhdGUiLCJwYXJzZSIsImxhc3RTaWduSW5UaW1lIiwiZGF0YSIsImdldEFkZGl0aW9uYWxVc2VySW5mbyIsImlzTmV3VXNlciIsInByb2ZpbGUiLCJ1c2VybmFtZSIsInVuZGVmaW5lZCIsIk9iamVjdCIsIkpTT04iLCJzdHJpbmdpZnkiXSwic291cmNlUm9vdCI6IiJ9